(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+rxp":function(n,e,t){"use strict";t.r(e),t.d(e,"PlacesPageModule",(function(){return m}));var r=t("ofXK"),a=t("3Pt+"),i=t("TEn/"),s=t("tyNb"),c=t("fXoL"),o=t("Qe3P"),u=t("sYmb");const l=[{path:"tabs",component:(()=>{class n{constructor(n){this.placesSrv=n}ngOnInit(){this.placesSrv.getCitiesInfo()}}return n.\u0275fac=function(e){return new(e||n)(c.Jb(o.a))},n.\u0275cmp=c.Db({type:n,selectors:[["app-places"]],decls:12,vars:6,consts:[["slot","bottom"],["tab","discover"],["name","search"],["tab","map"],["name","earth"]],template:function(n,e){1&n&&(c.Mb(0,"ion-tabs"),c.Mb(1,"ion-tab-bar",0),c.Mb(2,"ion-tab-button",1),c.Mb(3,"ion-label"),c.mc(4),c.Xb(5,"translate"),c.Lb(),c.Kb(6,"ion-icon",2),c.Lb(),c.Mb(7,"ion-tab-button",3),c.Mb(8,"ion-label"),c.mc(9),c.Xb(10,"translate"),c.Lb(),c.Kb(11,"ion-icon",4),c.Lb(),c.Lb(),c.Lb()),2&n&&(c.zb(4),c.nc(c.Yb(5,2,"DISCOVER.Discover")),c.zb(5),c.nc(c.Yb(10,4,"DISCOVER.Map")))},directives:[i.K,i.I,i.J,i.v,i.r],pipes:[u.c],styles:[""]}),n})(),children:[{path:"discover",children:[{path:"",loadChildren:()=>Promise.all([t.e(0),t.e(15)]).then(t.bind(null,"wfl+")).then(n=>n.DiscoverPageModule)},{path:"offer",loadChildren:()=>t.e(0).then(t.bind(null,"nlsp")).then(n=>n.OfferPageModule)},{path:":pathId",loadChildren:()=>Promise.all([t.e(0),t.e(14)]).then(t.bind(null,"jgUy")).then(n=>n.DetailsPageModule)}]},{path:"map",children:[{path:"",loadChildren:()=>t.e(11).then(t.bind(null,"zMet")).then(n=>n.MapPageModule)}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}];let h=(()=>{class n{}return n.\u0275mod=c.Hb({type:n}),n.\u0275inj=c.Gb({factory:function(e){return new(e||n)},imports:[[s.j.forChild(l)],s.j]}),n})();var d=t("PCNd");let m=(()=>{class n{}return n.\u0275mod=c.Hb({type:n}),n.\u0275inj=c.Gb({factory:function(e){return new(e||n)},imports:[[r.b,a.a,i.N,h,d.a]]}),n})()},Qe3P:function(n,e,t){"use strict";t.d(e,"a",(function(){return R}));var r=t("2Vo4"),a=t("XNiG"),i=t("LRne"),s=t("vkgz"),c=t("lJxs"),o=function(n){return n.FLIGHT='<span class="material-icons">\n    flight\n    </span>',n.BUS='<span class="material-icons">\n    directions_bus\n    </span>',n.TRAIN='<span class="material-icons">\n    directions_railway\n    </span>',n.CAR_FERRY='<span class="material-icons">\n    directions_boat\n    </span>',n.WALK='<span class="material-icons">\n    directions_walk\n    </span>',n.TOWN_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.TAXI='<span class="material-icons">\n    local_taxi\n    </span>',n.SHUTTLE='<span class="material-icons">\n    shuttle\n    </span>',n.DRIVE_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.RIDE_SHARE='<span class="material-icons">\n    groups\n    </span>',n}({});const u=new Map;u.set("Bus",o.BUS),u.set("Train",o.TRAIN),u.set("Ride Share",o.RIDE_SHARE),u.set("Taxi",o.TAXI),u.set("Flight",o.FLIGHT),u.set("Town Car",o.TOWN_CAR),u.set("Drive Car",o.DRIVE_CAR),u.set("Shuttle",o.SHUTTLE),u.set("Car Ferry",o.CAR_FERRY),u.set("Walk",o.WALK);var l=t("fXoL"),h=t("AytR"),d=t("tk/3");let m=(()=>{class n{constructor(n){this.http=n,this.URL=h.a.url2}getCities(){return this.http.get(this.URL+"/locations/all")}getPaths(n,e){return this.http.get(`${this.URL}/routes?from=${n}&to=${e}`,{observe:"response"})}getCurencyRate(n){return this.http.get(`https://free.currconv.com/api/v7/convert?q=EUR_${n}&compact=ultra&apiKey=31d8c7a521820803e1aa`)}getCitiesInfo(){return this.http.get("assets/data/coordinates.csv",{responseType:"text"})}}return n.\u0275fac=function(e){return new(e||n)(l.Qb(d.a))},n.\u0275prov=l.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var p=t("TEn/"),y=t("tyNb"),b=t("sYmb");const S=new Map;S.set("Ground route","../../assets/images/groundWay.png"),S.set("Mixed route","../../assets/images/mixedWay.png"),S.set("Flying route","../../assets/images/flightWay.png");const g=new Map;g.set("EUR",{name:"Euro",rate:1}),g.set("USD",{name:"USD",rate:0}),g.set("RUB",{name:"RUB",rate:0}),g.set("RUB",{name:"RUB",rate:0});let R=(()=>{class n{constructor(n,e,t,i){this.httpSrv=n,this.alertCtrl=e,this.router=t,this.translate=i,this.allCities=[],this.currentCurrency="EUR",this.currentCurrencyRate=1,this.languageChanged=!1,this.coordInfoRecieved=!1,this.pathsSubj$=new r.a([]),this.cleanPathsSubj$=new a.a,this.currencyChanged$=new a.a}getCurrencyArray(){return Object.keys(JSON.parse('{\n      "EUR": {\n        "currencyName": "Euro",\n        "currencySymbol": "\u20ac",\n        "id": "EUR"\n      },\n      "USD": {\n        "currencyName": "United States Dollar",\n        "currencySymbol": "$",\n        "id": "USD"\n      },\n      "HUF": {\n        "currencyName": "Hungarian Forint",\n        "currencySymbol": "Ft",\n        "id": "HUF"\n      },\n      "MKD": {\n        "currencyName": "Macedonian Denar",\n        "currencySymbol": "\u0434\u0435\u043d",\n        "id": "MKD"\n      },\n      "RSD": {\n        "currencyName": "Serbian Dinar",\n        "currencySymbol": "\u0414\u0438\u043d.",\n        "id": "RSD"\n      },\n      "SEK": {\n        "currencyName": "Swedish Krona",\n        "currencySymbol": "kr",\n        "id": "SEK"\n      },\n      "AMD": {\n        "currencyName": "Armenian Dram",\n        "id": "AMD"\n      },\n      "CZK": {\n        "currencyName": "Czech Koruna",\n        "currencySymbol": "K\u010d",\n        "id": "CZK"\n      },\n      "GEL": {\n        "currencyName": "Georgian Lari",\n        "id": "GEL"\n      },\n      "DKK": {\n        "currencyName": "Danish Krone",\n        "currencySymbol": "kr",\n        "id": "DKK"\n      },\n      "ILS": {\n        "currencyName": "Israeli New Sheqel",\n        "currencySymbol": "\u20aa",\n        "id": "ILS"\n      },\n      "KZT": {\n        "currencyName": "Kazakhstani Tenge",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KZT"\n      },\n      "RON": {\n        "currencyName": "Romanian Leu",\n        "currencySymbol": "lei",\n        "id": "RON"\n      },\n      "AZN": {\n        "currencyName": "Azerbaijani Manat",\n        "currencySymbol": "\u043c\u0430\u043d",\n        "id": "AZN"\n      },\n      "BYR": {\n        "currencyName": "Belarusian Ruble",\n        "currencySymbol": "p.",\n        "id": "BYR"\n      },\n      "BGN": {\n        "currencyName": "Bulgarian Lev",\n        "currencySymbol": "\u043b\u0432",\n        "id": "BGN"\n      },\n      "CAD": {\n        "currencyName": "Canadian Dollar",\n        "currencySymbol": "$",\n        "id": "CAD"\n      },\n      "ISK": {\n        "currencyName": "Icelandic Kr\xf3na",\n        "currencySymbol": "kr",\n        "id": "ISK"\n      },\n      "JPY": {\n        "currencyName": "Japanese Yen",\n        "currencySymbol": "\xa5",\n        "id": "JPY"\n      },\n      "LVL": {\n        "currencyName": "Latvian Lats",\n        "currencySymbol": "Ls",\n        "id": "LVL"\n      },\n      "CHF": {\n        "currencyName": "Swiss Franc",\n        "currencySymbol": "Fr.",\n        "id": "CHF"\n      },\n      "MDL": {\n        "currencyName": "Moldovan Leu",\n        "id": "MDL"\n      },\n      "KGS": {\n        "currencyName": "Kyrgyzstani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KGS"\n      },\n      "NOK": {\n        "currencyName": "Norwegian Krone",\n        "currencySymbol": "kr",\n        "id": "NOK"\n      },\n      "PLN": {\n        "currencyName": "Polish Zloty",\n        "currencySymbol": "z\u0142",\n        "id": "PLN"\n      },\n      "RUB": {\n        "currencyName": "Russian Ruble",\n        "currencySymbol": "\u0440\u0443\u0431",\n        "id": "RUB"\n      },\n      "TJS": {\n        "currencyName": "Tajikistani Somoni",\n        "id": "TJS"\n      },\n      "UAH": {\n        "currencyName": "Ukrainian Hryvnia",\n        "currencySymbol": "\u20b4",\n        "id": "UAH"\n      },\n      "UZS": {\n        "currencyName": "Uzbekistani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "UZS"\n      },\n      "TMT": {\n        "currencyName": "Turkmenistan Manat",\n        "id": "TMT"\n      },\n      "GBP": {\n        "currencyName": "British Pound",\n        "currencySymbol": "\xa3",\n        "id": "GBP"\n      }\n      \n}'))}getAllCities(){this.httpSrv.getCitiesInfo()}getStartPointAutocomplete(n){return this.getCitiesAutocomplete(n).pipe(Object(s.a)(e=>{n.match(/^[A-Za-z0-9]+$/)?0==e.length&&this.errorHandler("NO_RESULTS_FOR_SEARCH"):this.errorHandler("LATIN_CHARACTERES")}))}getEndPointAutocomplete(n){return this.getCitiesAutocomplete(n).pipe(Object(s.a)(e=>{n.match(/^[A-Za-z0-9]+$/)?0==e.length&&this.errorHandler("NO_RESULTS_FOR_SEARCH"):this.errorHandler("LATIN_CHARACTERES")}))}getPaths(n,e){this.startPointCity=n,this.endPointCity=e,this.httpSrv.getPaths(n.id,e.id).pipe(Object(c.a)(n=>{let e=n.body;for(let r=1;r<=e.length-1;r++)e[0].duration_minutes===e[r].duration_minutes&&n.body[0].euro_price===n.body[r].euro_price&&(e[r].duration_minutes=0,e[r].euro_price=0);const t=e.filter(n=>"0"!=n.duration_minutes).map(n=>this.transformPath(n)).sort((n,e)=>+n.euro_price-+e.euro_price);return this.currentPaths=t,t})).subscribe(n=>{if(this.paths=n,0===n.length)return this.errorHandler("NO_RESULTS_FOR_SEARCH"),this.cleanPathsSubj$.next(!0),void this.pathsSubj$.next([]);this.pathsSubj$.next(this.paths)})}getPathDetail(n){return this.currentPaths.find(e=>e.routeType===n)}errorHandler(n){this.alertCtrl.create({header:this.translate.instant(`ERRORS:${n}.Header`),message:this.translate.instant(`ERRORS:${n}.Message`),buttons:[{text:this.translate.instant(`ERRORS:${n}.Button`),handler:()=>{this.router.navigate(["/places/tabs/discover"])}}]}).then(n=>{n.present()})}transformPathDetails(n){return n.map(n=>Object.assign(Object.assign({},n),{cityFrom:this.allCities.filter(e=>e.id===n.from_id)[0],cityTo:this.allCities.filter(e=>e.id===n.to_id)[0],duration_minutes:this.transformDuration(n.duration_minutes.toString()),euro_price:this.transformPrice(n.euro_price.toString()),imgUrl:u.get(n.transportation_type),transportation_type:this.translate.instant("TRANSPORTATION_TYPE."+n.transportation_type)}))}transformPath(n){return Object.assign(Object.assign({},n),{duration_minutes:this.transformDuration(n.duration_minutes.toString()),euro_price:this.transformPrice(n.euro_price.toString()),direct_paths:this.transformPathDetails(n.direct_paths),imgUrl:S.get(n.routeType),routeType:this.translate.instant("ROUT_TYPE."+n.routeType)})}transformDuration(n){const e=Math.floor(+n/60/24),t=e<1?"":e+"d",r=Math.floor(+n/60-24*e);return t+" "+(r<1?"":r+"h")+" "+(+n-24*e*60-60*r)+"min"}transformPrice(n){return+Math.floor(+n)*this.currentCurrencyRate}getCitiesAutocomplete(n){const e=this.allCities.filter(e=>e.name.toLowerCase().indexOf(n.toLowerCase())>-1).map((e,t,r)=>Object.assign(Object.assign({},e),{index:e.name.toLowerCase().indexOf(n.toLowerCase())})).sort((n,e)=>n.index-e.index).map(n=>({id:n.id,name:n.name})).slice(0,10);return Object(i.a)(e)}getCurrencyRate(n,e){this.currentCurrency=n,this.httpSrv.getCurencyRate(n).subscribe(n=>{const t=this.currentCurrencyRate;this.currentCurrencyRate=+Object.values(n)[0],e&&this.currencyChanged$.next({name:this.currentCurrency,rate:this.currentCurrencyRate,previousRate:t})})}setLanguage(n,e){this.currentLanguage=n,this.languageChanged=e}getFullCityInformation(n){return this.coordInfoRecieved||this.getCitiesInfo(),this.allCities.filter(e=>e.id===+n)[0]}getCitiesInfo(){this.httpSrv.getCitiesInfo().subscribe(n=>{const e=n.toString().split("\n").map(n=>this.convertToObject(n));this.allCities=e})}convertToObject(n){const e=n.toString().split(";");return{id:+e[0],name:e[1],country:e[7],coordinates:{latitude:e[3]?+e[3].split(",").join("."):NaN,longitude:e[4]?+e[4].split(",").join("."):NaN}}}}return n.\u0275fac=function(e){return new(e||n)(l.Qb(m),l.Qb(p.a),l.Qb(y.g),l.Qb(b.d))},n.\u0275prov=l.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}]);