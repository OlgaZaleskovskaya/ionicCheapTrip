(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+rxp":function(n,t,e){"use strict";e.r(t),e.d(t,"PlacesPageModule",(function(){return m}));var r=e("ofXK"),a=e("3Pt+"),i=e("TEn/"),s=e("tyNb"),c=e("fXoL"),o=e("Qe3P"),u=e("sYmb");const l=[{path:"tabs",component:(()=>{class n{constructor(n){this.placesSrv=n}ngOnInit(){this.placesSrv.getCitiesInfo()}}return n.\u0275fac=function(t){return new(t||n)(c.Jb(o.a))},n.\u0275cmp=c.Db({type:n,selectors:[["app-places"]],decls:12,vars:6,consts:[["slot","bottom"],["tab","discover"],["name","search"],["tab","map"],["name","earth"]],template:function(n,t){1&n&&(c.Mb(0,"ion-tabs"),c.Mb(1,"ion-tab-bar",0),c.Mb(2,"ion-tab-button",1),c.Mb(3,"ion-label"),c.mc(4),c.Xb(5,"translate"),c.Lb(),c.Kb(6,"ion-icon",2),c.Lb(),c.Mb(7,"ion-tab-button",3),c.Mb(8,"ion-label"),c.mc(9),c.Xb(10,"translate"),c.Lb(),c.Kb(11,"ion-icon",4),c.Lb(),c.Lb(),c.Lb()),2&n&&(c.zb(4),c.nc(c.Yb(5,2,"DISCOVER.Discover")),c.zb(5),c.nc(c.Yb(10,4,"DISCOVER.Map")))},directives:[i.K,i.I,i.J,i.v,i.r],pipes:[u.c],styles:[""]}),n})(),children:[{path:"discover",children:[{path:"",loadChildren:()=>Promise.all([e.e(0),e.e(15)]).then(e.bind(null,"wfl+")).then(n=>n.DiscoverPageModule)},{path:"offer",loadChildren:()=>e.e(0).then(e.bind(null,"nlsp")).then(n=>n.OfferPageModule)},{path:":pathId",loadChildren:()=>Promise.all([e.e(0),e.e(14)]).then(e.bind(null,"jgUy")).then(n=>n.DetailsPageModule)}]},{path:"map",children:[{path:"",loadChildren:()=>e.e(11).then(e.bind(null,"zMet")).then(n=>n.MapPageModule)}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}];let h=(()=>{class n{}return n.\u0275mod=c.Hb({type:n}),n.\u0275inj=c.Gb({factory:function(t){return new(t||n)},imports:[[s.j.forChild(l)],s.j]}),n})();var d=e("PCNd");let m=(()=>{class n{}return n.\u0275mod=c.Hb({type:n}),n.\u0275inj=c.Gb({factory:function(t){return new(t||n)},imports:[[r.b,a.a,i.N,h,d.a]]}),n})()},Qe3P:function(n,t,e){"use strict";e.d(t,"a",(function(){return g}));var r=e("2Vo4"),a=e("XNiG"),i=e("LRne"),s=e("vkgz"),c=e("lJxs"),o=e("Ul1M"),u=e("fXoL"),l=e("AytR"),h=e("tk/3");let d=(()=>{class n{constructor(n){this.http=n,this.URL=l.a.url2}getCities(){return this.http.get(this.URL+"/locations/all")}getPaths(n,t){return this.http.get(`${this.URL}/routes?from=${n}&to=${t}`,{observe:"response"})}getCurencyRate(n){return this.http.get(`https://free.currconv.com/api/v7/convert?q=EUR_${n}&compact=ultra&apiKey=31d8c7a521820803e1aa`)}getCitiesInfo(){return this.http.get("assets/data/coordinates.csv",{responseType:"text"})}}return n.\u0275fac=function(t){return new(t||n)(u.Qb(h.a))},n.\u0275prov=u.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var m=e("TEn/"),p=e("tyNb"),y=e("sYmb");const b=new Map;b.set("Ground route","../../assets/images/groundWay.png"),b.set("Mixed route","../../assets/images/mixedWay.png"),b.set("Flying route","../../assets/images/flightWay.png");const S=new Map;S.set("EUR",{name:"Euro",rate:1}),S.set("USD",{name:"USD",rate:0}),S.set("RUB",{name:"RUB",rate:0}),S.set("RUB",{name:"RUB",rate:0});let g=(()=>{class n{constructor(n,t,e,i){this.httpSrv=n,this.alertCtrl=t,this.router=e,this.translate=i,this.allCities=[],this.currentCurrency="EUR",this.currentCurrencyRate=1,this.languageChanged=!1,this.coordInfoRecieved=!1,this.pathsSubj$=new r.a([]),this.cleanPathsSubj$=new a.a,this.currencyChanged$=new a.a}getCurrencyArray(){return Object.keys(JSON.parse('{\n      "EUR": {\n        "currencyName": "Euro",\n        "currencySymbol": "\u20ac",\n        "id": "EUR"\n      },\n      "USD": {\n        "currencyName": "United States Dollar",\n        "currencySymbol": "$",\n        "id": "USD"\n      },\n      "HUF": {\n        "currencyName": "Hungarian Forint",\n        "currencySymbol": "Ft",\n        "id": "HUF"\n      },\n      "MKD": {\n        "currencyName": "Macedonian Denar",\n        "currencySymbol": "\u0434\u0435\u043d",\n        "id": "MKD"\n      },\n      "RSD": {\n        "currencyName": "Serbian Dinar",\n        "currencySymbol": "\u0414\u0438\u043d.",\n        "id": "RSD"\n      },\n      "SEK": {\n        "currencyName": "Swedish Krona",\n        "currencySymbol": "kr",\n        "id": "SEK"\n      },\n      "AMD": {\n        "currencyName": "Armenian Dram",\n        "id": "AMD"\n      },\n      "CZK": {\n        "currencyName": "Czech Koruna",\n        "currencySymbol": "K\u010d",\n        "id": "CZK"\n      },\n      "GEL": {\n        "currencyName": "Georgian Lari",\n        "id": "GEL"\n      },\n      "DKK": {\n        "currencyName": "Danish Krone",\n        "currencySymbol": "kr",\n        "id": "DKK"\n      },\n      "ILS": {\n        "currencyName": "Israeli New Sheqel",\n        "currencySymbol": "\u20aa",\n        "id": "ILS"\n      },\n      "KZT": {\n        "currencyName": "Kazakhstani Tenge",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KZT"\n      },\n      "RON": {\n        "currencyName": "Romanian Leu",\n        "currencySymbol": "lei",\n        "id": "RON"\n      },\n      "AZN": {\n        "currencyName": "Azerbaijani Manat",\n        "currencySymbol": "\u043c\u0430\u043d",\n        "id": "AZN"\n      },\n      "BYR": {\n        "currencyName": "Belarusian Ruble",\n        "currencySymbol": "p.",\n        "id": "BYR"\n      },\n      "BGN": {\n        "currencyName": "Bulgarian Lev",\n        "currencySymbol": "\u043b\u0432",\n        "id": "BGN"\n      },\n      "CAD": {\n        "currencyName": "Canadian Dollar",\n        "currencySymbol": "$",\n        "id": "CAD"\n      },\n      "ISK": {\n        "currencyName": "Icelandic Kr\xf3na",\n        "currencySymbol": "kr",\n        "id": "ISK"\n      },\n      "JPY": {\n        "currencyName": "Japanese Yen",\n        "currencySymbol": "\xa5",\n        "id": "JPY"\n      },\n      "LVL": {\n        "currencyName": "Latvian Lats",\n        "currencySymbol": "Ls",\n        "id": "LVL"\n      },\n      "CHF": {\n        "currencyName": "Swiss Franc",\n        "currencySymbol": "Fr.",\n        "id": "CHF"\n      },\n      "MDL": {\n        "currencyName": "Moldovan Leu",\n        "id": "MDL"\n      },\n      "KGS": {\n        "currencyName": "Kyrgyzstani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KGS"\n      },\n      "NOK": {\n        "currencyName": "Norwegian Krone",\n        "currencySymbol": "kr",\n        "id": "NOK"\n      },\n      "PLN": {\n        "currencyName": "Polish Zloty",\n        "currencySymbol": "z\u0142",\n        "id": "PLN"\n      },\n      "RUB": {\n        "currencyName": "Russian Ruble",\n        "currencySymbol": "\u0440\u0443\u0431",\n        "id": "RUB"\n      },\n      "TJS": {\n        "currencyName": "Tajikistani Somoni",\n        "id": "TJS"\n      },\n      "UAH": {\n        "currencyName": "Ukrainian Hryvnia",\n        "currencySymbol": "\u20b4",\n        "id": "UAH"\n      },\n      "UZS": {\n        "currencyName": "Uzbekistani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "UZS"\n      },\n      "TMT": {\n        "currencyName": "Turkmenistan Manat",\n        "id": "TMT"\n      },\n      "GBP": {\n        "currencyName": "British Pound",\n        "currencySymbol": "\xa3",\n        "id": "GBP"\n      }\n      \n}'))}getAllCities(){this.httpSrv.getCitiesInfo()}getStartPointAutocomplete(n){return this.getCitiesAutocomplete(n).pipe(Object(s.a)(t=>{n.match(/^[A-Za-z0-9]+$/)?0==t.length&&this.errorHandler("NO_RESULTS_FOR_SEARCH"):this.errorHandler("LATIN_CHARACTERES")}))}getEndPointAutocomplete(n){return this.getCitiesAutocomplete(n).pipe(Object(s.a)(t=>{n.match(/^[A-Za-z0-9]+$/)?0==t.length&&this.errorHandler("NO_RESULTS_FOR_SEARCH"):this.errorHandler("LATIN_CHARACTERES")}))}getPaths(n,t){this.startPointCity=n,this.endPointCity=t,this.httpSrv.getPaths(n.id,t.id).pipe(Object(c.a)(n=>{let t=n.body;for(let r=1;r<=t.length-1;r++)t[0].duration_minutes===t[r].duration_minutes&&n.body[0].euro_price===n.body[r].euro_price&&(t[r].duration_minutes=0,t[r].euro_price=0);const e=t.filter(n=>"0"!=n.duration_minutes).map(n=>this.transformPath(n)).sort((n,t)=>+n.euro_price-+t.euro_price);return this.currentPaths=e,e})).subscribe(n=>{if(this.paths=n,0===n.length)return this.errorHandler("NO_RESULTS_FOR_SEARCH"),this.cleanPathsSubj$.next(!0),void this.pathsSubj$.next([]);this.pathsSubj$.next(this.paths)})}getPathDetail(n){return this.currentPaths.find(t=>t.routeType===n)}errorHandler(n){this.alertCtrl.create({header:this.translate.instant(`ERRORS:${n}.Header`),message:this.translate.instant(`ERRORS:${n}.Message`),buttons:[{text:this.translate.instant(`ERRORS:${n}.Button`),handler:()=>{this.router.navigate(["/places/tabs/discover"])}}]}).then(n=>{n.present()})}transformPathDetails(n){return n.map(n=>Object.assign(Object.assign({},n),{cityFrom:this.allCities.filter(t=>t.id===n.from_id)[0],cityTo:this.allCities.filter(t=>t.id===n.to_id)[0],duration_minutes:this.transformDuration(n.duration_minutes.toString()),euro_price:this.transformPrice(n.euro_price.toString()),imgUrl:o.a.get(n.transportation_type),transportation_type:this.translate.instant("TRANSPORTATION_TYPE."+n.transportation_type),transport:n.transportation_type}))}transformPath(n){return Object.assign(Object.assign({},n),{duration_minutes:this.transformDuration(n.duration_minutes.toString()),euro_price:this.transformPrice(n.euro_price.toString()),direct_paths:this.transformPathDetails(n.direct_paths),imgUrl:b.get(n.routeType),routeType:this.translate.instant("ROUT_TYPE."+n.routeType)})}transformDuration(n){const t=Math.floor(+n/60/24),e=t<1?"":t+"d",r=Math.floor(+n/60-24*t);return e+" "+(r<1?"":r+"h")+" "+(+n-24*t*60-60*r)+"min"}transformPrice(n){return+Math.floor(+n)*this.currentCurrencyRate}getCitiesAutocomplete(n){const t=this.allCities.filter(t=>t.name.toLowerCase().indexOf(n.toLowerCase())>-1).map((t,e,r)=>Object.assign(Object.assign({},t),{index:t.name.toLowerCase().indexOf(n.toLowerCase())})).sort((n,t)=>n.index-t.index).map(n=>({id:n.id,name:n.name})).slice(0,10);return Object(i.a)(t)}getCurrencyRate(n,t){this.currentCurrency=n,this.httpSrv.getCurencyRate(n).subscribe(n=>{const e=this.currentCurrencyRate;this.currentCurrencyRate=+Object.values(n)[0],t&&this.currencyChanged$.next({name:this.currentCurrency,rate:this.currentCurrencyRate,previousRate:e})})}setLanguage(n,t){this.currentLanguage=n,this.languageChanged=t}getFullCityInformation(n){return this.coordInfoRecieved||this.getCitiesInfo(),this.allCities.filter(t=>t.id===+n)[0]}getCitiesInfo(){this.httpSrv.getCitiesInfo().subscribe(n=>{const t=n.toString().split("\n").map(n=>this.convertToObject(n));this.allCities=t})}convertToObject(n){const t=n.toString().split(";");return{id:+t[0],name:t[1],country:t[7],coordinates:{latitude:t[3]?+t[3].split(",").join("."):NaN,longitude:t[4]?+t[4].split(",").join("."):NaN}}}}return n.\u0275fac=function(t){return new(t||n)(u.Qb(d),u.Qb(m.a),u.Qb(p.g),u.Qb(y.d))},n.\u0275prov=u.Fb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},Ul1M:function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));var r=function(n){return n.FLIGHT='<span class="material-icons">\n    flight\n    </span>',n.BUS='<span class="material-icons">\n    directions_bus\n    </span>',n.TRAIN='<span class="material-icons">\n    directions_railway\n    </span>',n.CAR_FERRY='<span class="material-icons">\n    directions_boat\n    </span>',n.WALK='<span class="material-icons">\n    directions_walk\n    </span>',n.TOWN_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.TAXI='<span class="material-icons">\n    local_taxi\n    </span>',n.SHUTTLE='<span class="material-icons">\n    shuttle\n    </span>',n.DRIVE_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.RIDE_SHARE='<span class="material-icons">\n    groups\n    </span>',n}({});const a=new Map;a.set("Bus",r.BUS),a.set("Train",r.TRAIN),a.set("Ride Share",r.RIDE_SHARE),a.set("Taxi",r.TAXI),a.set("Flight",r.FLIGHT),a.set("Town Car",r.TOWN_CAR),a.set("Drive Car",r.DRIVE_CAR),a.set("Shuttle",r.SHUTTLE),a.set("Car Ferry",r.CAR_FERRY),a.set("Walk",r.WALK)}}]);