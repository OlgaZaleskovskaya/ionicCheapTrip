!function(){function n(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function e(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function t(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+rxp":function(e,r,a){"use strict";a.r(r),a.d(r,"PlacesPageModule",(function(){return S}));var i,c,o,s=a("ofXK"),u=a("3Pt+"),l=a("TEn/"),y=a("tyNb"),h=a("fXoL"),d=a("Qe3P"),m=a("sYmb"),p=[{path:"tabs",component:(i=function(){function e(t){n(this,e),this.placesSrv=t}return t(e,[{key:"ngOnInit",value:function(){this.placesSrv.getCitiesInfo()}}]),e}(),i.\u0275fac=function(n){return new(n||i)(h.Jb(d.a))},i.\u0275cmp=h.Db({type:i,selectors:[["app-places"]],decls:12,vars:6,consts:[["slot","bottom"],["tab","discover"],["name","search"],["tab","multi"],["name","earth"]],template:function(n,e){1&n&&(h.Mb(0,"ion-tabs"),h.Mb(1,"ion-tab-bar",0),h.Mb(2,"ion-tab-button",1),h.Mb(3,"ion-label"),h.mc(4),h.Xb(5,"translate"),h.Lb(),h.Kb(6,"ion-icon",2),h.Lb(),h.Mb(7,"ion-tab-button",3),h.Mb(8,"ion-label"),h.mc(9),h.Xb(10,"translate"),h.Lb(),h.Kb(11,"ion-icon",4),h.Lb(),h.Lb(),h.Lb()),2&n&&(h.zb(4),h.nc(h.Yb(5,2,"DISCOVER.Discover")),h.zb(5),h.nc(h.Yb(10,4,"DISCOVER.MultiCity")))},directives:[l.K,l.I,l.J,l.v,l.r],pipes:[m.c],styles:[""]}),i),children:[{path:"discover",children:[{path:"",loadChildren:function(){return Promise.all([a.e(0),a.e(15)]).then(a.bind(null,"wfl+")).then((function(n){return n.DiscoverPageModule}))}},{path:"offer",loadChildren:function(){return a.e(0).then(a.bind(null,"nlsp")).then((function(n){return n.OfferPageModule}))}},{path:":pathId",loadChildren:function(){return Promise.all([a.e(0),a.e(14)]).then(a.bind(null,"jgUy")).then((function(n){return n.DetailsPageModule}))}}]},{path:"multi",children:[{path:"",loadChildren:function(){return a.e(11).then(a.bind(null,"zMet")).then((function(n){return n.MapPageModule}))}}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}]},{path:"",redirectTo:"/places/tabs/discover",pathMatch:"full"}],f=((c=function e(){n(this,e)}).\u0275mod=h.Hb({type:c}),c.\u0275inj=h.Gb({factory:function(n){return new(n||c)},imports:[[y.j.forChild(p)],y.j]}),c),b=a("PCNd"),S=((o=function e(){n(this,e)}).\u0275mod=h.Hb({type:o}),o.\u0275inj=h.Gb({factory:function(n){return new(n||o)},imports:[[s.b,u.a,l.N,f,b.a]]}),o)},Qe3P:function(e,r,a){"use strict";a.d(r,"a",(function(){return N}));var i=a("2Vo4"),c=a("XNiG"),o=a("LRne"),s=a("vkgz"),u=a("lJxs"),l=function(n){return n.FLIGHT='<span class="material-icons">\n    flight\n    </span>',n.BUS='<span class="material-icons">\n    directions_bus\n    </span>',n.TRAIN='<span class="material-icons">\n    directions_railway\n    </span>',n.CAR_FERRY='<span class="material-icons">\n    directions_boat\n    </span>',n.WALK='<span class="material-icons">\n    directions_walk\n    </span>',n.TOWN_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.TAXI='<span class="material-icons">\n    local_taxi\n    </span>',n.SHUTTLE='<span class="material-icons">\n    shuttle\n    </span>',n.DRIVE_CAR='<span class="material-icons">\n    directions_car\n    </span>',n.RIDE_SHARE='<span class="material-icons">\n    groups\n    </span>',n}({}),y=new Map;y.set("Bus",l.BUS),y.set("Train",l.TRAIN),y.set("Ride Share",l.RIDE_SHARE),y.set("Taxi",l.TAXI),y.set("Flight",l.FLIGHT),y.set("Town Car",l.TOWN_CAR),y.set("Drive Car",l.DRIVE_CAR),y.set("Shuttle",l.SHUTTLE),y.set("Car Ferry",l.CAR_FERRY),y.set("Walk",l.WALK);var h,d=a("fXoL"),m=a("AytR"),p=a("tk/3"),f=((h=function(){function e(t){n(this,e),this.http=t,this.URL=m.a.url2}return t(e,[{key:"getCities",value:function(){return this.http.get(this.URL+"/locations/all")}},{key:"getPaths",value:function(n,e){return this.http.get("".concat(this.URL,"/routes?from=").concat(n,"&to=").concat(e),{observe:"response"})}},{key:"getCurencyRate",value:function(n){return this.http.get("https://free.currconv.com/api/v7/convert?q=EUR_".concat(n,"&compact=ultra&apiKey=31d8c7a521820803e1aa"))}},{key:"getCitiesInfo",value:function(){return this.http.get("assets/data/coordinates.csv",{responseType:"text"})}}]),e}()).\u0275fac=function(n){return new(n||h)(d.Qb(p.a))},h.\u0275prov=d.Fb({token:h,factory:h.\u0275fac,providedIn:"root"}),h),b=a("TEn/"),S=a("tyNb"),g=a("sYmb"),v=new Map;v.set("Ground route","../../assets/images/groundWay.png"),v.set("Mixed route","../../assets/images/mixedWay.png"),v.set("Flying route","../../assets/images/flightWay.png");var R=new Map;R.set("EUR",{name:"Euro",rate:1}),R.set("USD",{name:"USD",rate:0}),R.set("RUB",{name:"RUB",rate:0}),R.set("RUB",{name:"RUB",rate:0});var C,N=((C=function(){function e(t,r,a,o){n(this,e),this.httpSrv=t,this.alertCtrl=r,this.router=a,this.translate=o,this.allCities=[],this.currentCurrency="EUR",this.currentCurrencyRate=1,this.languageChanged=!1,this.coordInfoRecieved=!1,this.pathsSubj$=new i.a([]),this.cleanPathsSubj$=new c.a,this.currencyChanged$=new c.a}return t(e,[{key:"getCurrencyArray",value:function(){return Object.keys(JSON.parse('{\n      "EUR": {\n        "currencyName": "Euro",\n        "currencySymbol": "\u20ac",\n        "id": "EUR"\n      },\n      "USD": {\n        "currencyName": "United States Dollar",\n        "currencySymbol": "$",\n        "id": "USD"\n      },\n      "HUF": {\n        "currencyName": "Hungarian Forint",\n        "currencySymbol": "Ft",\n        "id": "HUF"\n      },\n      "MKD": {\n        "currencyName": "Macedonian Denar",\n        "currencySymbol": "\u0434\u0435\u043d",\n        "id": "MKD"\n      },\n      "RSD": {\n        "currencyName": "Serbian Dinar",\n        "currencySymbol": "\u0414\u0438\u043d.",\n        "id": "RSD"\n      },\n      "SEK": {\n        "currencyName": "Swedish Krona",\n        "currencySymbol": "kr",\n        "id": "SEK"\n      },\n      "AMD": {\n        "currencyName": "Armenian Dram",\n        "id": "AMD"\n      },\n      "CZK": {\n        "currencyName": "Czech Koruna",\n        "currencySymbol": "K\u010d",\n        "id": "CZK"\n      },\n      "GEL": {\n        "currencyName": "Georgian Lari",\n        "id": "GEL"\n      },\n      "DKK": {\n        "currencyName": "Danish Krone",\n        "currencySymbol": "kr",\n        "id": "DKK"\n      },\n      "ILS": {\n        "currencyName": "Israeli New Sheqel",\n        "currencySymbol": "\u20aa",\n        "id": "ILS"\n      },\n      "KZT": {\n        "currencyName": "Kazakhstani Tenge",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KZT"\n      },\n      "RON": {\n        "currencyName": "Romanian Leu",\n        "currencySymbol": "lei",\n        "id": "RON"\n      },\n      "AZN": {\n        "currencyName": "Azerbaijani Manat",\n        "currencySymbol": "\u043c\u0430\u043d",\n        "id": "AZN"\n      },\n      "BYR": {\n        "currencyName": "Belarusian Ruble",\n        "currencySymbol": "p.",\n        "id": "BYR"\n      },\n      "BGN": {\n        "currencyName": "Bulgarian Lev",\n        "currencySymbol": "\u043b\u0432",\n        "id": "BGN"\n      },\n      "CAD": {\n        "currencyName": "Canadian Dollar",\n        "currencySymbol": "$",\n        "id": "CAD"\n      },\n      "ISK": {\n        "currencyName": "Icelandic Kr\xf3na",\n        "currencySymbol": "kr",\n        "id": "ISK"\n      },\n      "JPY": {\n        "currencyName": "Japanese Yen",\n        "currencySymbol": "\xa5",\n        "id": "JPY"\n      },\n      "LVL": {\n        "currencyName": "Latvian Lats",\n        "currencySymbol": "Ls",\n        "id": "LVL"\n      },\n      "CHF": {\n        "currencyName": "Swiss Franc",\n        "currencySymbol": "Fr.",\n        "id": "CHF"\n      },\n      "MDL": {\n        "currencyName": "Moldovan Leu",\n        "id": "MDL"\n      },\n      "KGS": {\n        "currencyName": "Kyrgyzstani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "KGS"\n      },\n      "NOK": {\n        "currencyName": "Norwegian Krone",\n        "currencySymbol": "kr",\n        "id": "NOK"\n      },\n      "PLN": {\n        "currencyName": "Polish Zloty",\n        "currencySymbol": "z\u0142",\n        "id": "PLN"\n      },\n      "RUB": {\n        "currencyName": "Russian Ruble",\n        "currencySymbol": "\u0440\u0443\u0431",\n        "id": "RUB"\n      },\n      "TJS": {\n        "currencyName": "Tajikistani Somoni",\n        "id": "TJS"\n      },\n      "UAH": {\n        "currencyName": "Ukrainian Hryvnia",\n        "currencySymbol": "\u20b4",\n        "id": "UAH"\n      },\n      "UZS": {\n        "currencyName": "Uzbekistani Som",\n        "currencySymbol": "\u043b\u0432",\n        "id": "UZS"\n      },\n      "TMT": {\n        "currencyName": "Turkmenistan Manat",\n        "id": "TMT"\n      },\n      "GBP": {\n        "currencyName": "British Pound",\n        "currencySymbol": "\xa3",\n        "id": "GBP"\n      }\n      \n}'))}},{key:"getAllCities",value:function(){this.httpSrv.getCitiesInfo()}},{key:"getStartPointAutocomplete",value:function(n){var e=this;return this.getCitiesAutocomplete(n).pipe(Object(s.a)((function(t){n.match(/^[A-Za-z0-9]+$/)?0==t.length&&e.errorHandler("NO_RESULTS_FOR_SEARCH"):e.errorHandler("LATIN_CHARACTERES")})))}},{key:"getEndPointAutocomplete",value:function(n){var e=this;return this.getCitiesAutocomplete(n).pipe(Object(s.a)((function(t){n.match(/^[A-Za-z0-9]+$/)?0==t.length&&e.errorHandler("NO_RESULTS_FOR_SEARCH"):e.errorHandler("LATIN_CHARACTERES")})))}},{key:"getPaths",value:function(n,e){var t=this;this.startPointCity=n,this.endPointCity=e,this.httpSrv.getPaths(n.id,e.id).pipe(Object(u.a)((function(n){for(var e=n.body,r=1;r<=e.length-1;r++)e[0].duration_minutes===e[r].duration_minutes&&n.body[0].euro_price===n.body[r].euro_price&&(e[r].duration_minutes=0,e[r].euro_price=0);var a=e.filter((function(n){return"0"!=n.duration_minutes})).map((function(n){return t.transformPath(n)})).sort((function(n,e){return+n.euro_price-+e.euro_price}));return t.currentPaths=a,a}))).subscribe((function(n){if(t.paths=n,0===n.length)return t.errorHandler("NO_RESULTS_FOR_SEARCH"),t.cleanPathsSubj$.next(!0),void t.pathsSubj$.next([]);t.pathsSubj$.next(t.paths)}))}},{key:"getPathDetail",value:function(n){return this.currentPaths.find((function(e){return e.routeType===n}))}},{key:"errorHandler",value:function(n){var e=this;this.alertCtrl.create({header:this.translate.instant("ERRORS:".concat(n,".Header")),message:this.translate.instant("ERRORS:".concat(n,".Message")),buttons:[{text:this.translate.instant("ERRORS:".concat(n,".Button")),handler:function(){e.router.navigate(["/places/tabs/discover"])}}]}).then((function(n){n.present()}))}},{key:"transformPathDetails",value:function(n){var e=this;return n.map((function(n){return Object.assign(Object.assign({},n),{cityFrom:e.allCities.filter((function(e){return e.id===n.from_id}))[0],cityTo:e.allCities.filter((function(e){return e.id===n.to_id}))[0],duration_minutes:e.transformDuration(n.duration_minutes.toString()),euro_price:e.transformPrice(n.euro_price.toString()),imgUrl:y.get(n.transportation_type),transportation_type:e.translate.instant("TRANSPORTATION_TYPE."+n.transportation_type)})}))}},{key:"transformPath",value:function(n){return Object.assign(Object.assign({},n),{duration_minutes:this.transformDuration(n.duration_minutes.toString()),euro_price:this.transformPrice(n.euro_price.toString()),direct_paths:this.transformPathDetails(n.direct_paths),imgUrl:v.get(n.routeType),routeType:this.translate.instant("ROUT_TYPE."+n.routeType)})}},{key:"transformDuration",value:function(n){var e=Math.floor(+n/60/24),t=e<1?"":e+"d",r=Math.floor(+n/60-24*e);return t+" "+(r<1?"":r+"h")+" "+(+n-24*e*60-60*r)+"min"}},{key:"transformPrice",value:function(n){return+Math.floor(+n)*this.currentCurrencyRate}},{key:"getCitiesAutocomplete",value:function(n){var e=this.allCities.filter((function(e){return e.name.toLowerCase().indexOf(n.toLowerCase())>-1})).map((function(e,t,r){return Object.assign(Object.assign({},e),{index:e.name.toLowerCase().indexOf(n.toLowerCase())})})).sort((function(n,e){return n.index-e.index})).map((function(n){return{id:n.id,name:n.name}})).slice(0,10);return Object(o.a)(e)}},{key:"getCurrencyRate",value:function(n,e){var t=this;this.currentCurrency=n,this.httpSrv.getCurencyRate(n).subscribe((function(n){var r=t.currentCurrencyRate;t.currentCurrencyRate=+Object.values(n)[0],e&&t.currencyChanged$.next({name:t.currentCurrency,rate:t.currentCurrencyRate,previousRate:r})}))}},{key:"setLanguage",value:function(n,e){this.currentLanguage=n,this.languageChanged=e}},{key:"transformPaths",value:function(){}},{key:"getFullCityInformation",value:function(n){return this.coordInfoRecieved||this.getCitiesInfo(),this.allCities.filter((function(e){return e.id===+n}))[0]}},{key:"getCitiesInfo",value:function(){var n=this;this.httpSrv.getCitiesInfo().subscribe((function(e){var t=e.toString().split("\r").map((function(e){return n.convertToObject(e)}));n.allCities=t}))}},{key:"convertToObject",value:function(n){var e=n.toString().split(";");return{id:+e[0],name:e[1],country:e[7],coordinates:{latitude:e[3]?+e[3].split(",").join("."):NaN,longitude:e[4]?+e[4].split(",").join("."):NaN}}}}]),e}()).\u0275fac=function(n){return new(n||C)(d.Qb(f),d.Qb(b.a),d.Qb(S.g),d.Qb(g.d))},C.\u0275prov=d.Fb({token:C,factory:C.\u0275fac,providedIn:"root"}),C)}}])}();